
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Timer Test – Mitte funktioniert</title>

<style>
body {
    font-family: sans-serif;
    padding: 20px;
    max-width: 300px;
    margin: auto;
}

/* Picker zeigt 3 Werte */
.picker {
    width: 100px;
    height: 120px; /* 3 × 40px */
    overflow-y: scroll;
    border: 1px solid black;
    position: relative;
    margin: auto;
}

/* Einzelelement */
.picker div {
    height: 40px;
    line-height: 40px;
    font-size: 22px;
    text-align: center;
    border-bottom: 1px solid #ddd;
}

/* FIXER Balken */
.picker::after {
    content: "";
    position: absolute;
    top: 40px;  /* Mitte (2. von 3 Zeilen) */
    left: 0;
    width: 100%;
    height: 40px;
    border-top: 2px solid green;
    border-bottom: 2px solid green;
    pointer-events: none;
    z-index: 10;
}
</style>
</head>

<body>

<h2>Test</h2>
<div class="picker" id="pick"></div>
<div>Auswahl: <span id="out">--</span></div>

<script>
const ITEM_HEIGHT = 40;
const pick = document.getElementById("pick");
const out = document.getElementById("out");

// Puffer
const topSpacer = document.createElement("div");
topSpacer.style.height = ITEM_HEIGHT + "px";
topSpacer.style.opacity = 0;

const bottomSpacer = topSpacer.cloneNode(true);

pick.appendChild(topSpacer);

// echte Werte
for (let i=0;i<=59;i++){
    const d=document.createElement("div");
    d.innerText=i.toString().padStart(2,"0");
    pick.appendChild(d);
}

pick.appendChild(bottomSpacer);

// Startwert = mittig 30
pick.scrollTop = (1 + 30) * ITEM_HEIGHT;


/* --- KORREKTE MITTELWERTAUSWAHL --- */
pick.addEventListener("scroll", ()=>{
    clearTimeout(pick._t);
    pick._t = setTimeout(()=>{

        // Der Mittelpunkt ist IMMER: scrollTop/40 + 1
        let idx = Math.round(pick.scrollTop / ITEM_HEIGHT);

        // korrektes Snapping:
        pick.scrollTop = idx * ITEM_HEIGHT;

        // echte Werte sind verschoben um +1 wegen TopSpacer
        let selected = idx - 1;

        if (selected < 0) selected = 0;
        if (selected > 59) selected = 59;

        out.innerText = selected.toString().padStart(2,"0");

    },120);
});
</script>

</body>
</html>
